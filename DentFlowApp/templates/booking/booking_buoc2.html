{% extends 'layout/base.html' %}

{% block title %}Đặt lịch khám{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/booking.css') }}"/>
<link rel="stylesheet" href="{{ url_for('static', filename='css/booking_buoc2.css') }}"/>
{% endblock %}

{% block content %}

<div class="booking-header">
    <div class="container d-flex justify-content-between align-items-center">
        <a href="/booking" class="btn-back"><i class="fas fa-arrow-left me-2"></i> Quay lại</a>
        <div class="fw-bold text-primary fs-5"><i class="fas fa-tooth"></i> DENTALFLOW </div>
        <div style="width: 80px;"></div>
    </div>
</div>

<div class="container">
    <div class="stepper-wrapper step-2-active">
        <div class="step-item completed">
            <div class="step-circle"><i class="fas fa-check"></i></div>
            <div class="step-text">Dịch vụ</div>
        </div>
        <div class="step-item active">
            <div class="step-circle">2</div>
            <div class="step-text">Thời gian</div>
        </div>
        <div class="step-item">
            <div class="step-circle">3</div>
            <div class="step-text">Xác nhận</div>
        </div>
    </div>

    <div class="booking-card">
        <div class="user-info-box">
            <div class="avatar-circle"><i class="far fa-user"></i></div>
            <div>
                <div class="small text-muted">Đặt lịch cho</div>
                <div class="fw-bold text-dark">{{ current_user.ho_ten if current_user.is_authenticated else 'Khách Vãng
                    Lai' }}
                </div>
                {% if 'booking_data' in session %}
                <div class="small text-primary"><i class="fas fa-tooth me-1"></i> Dịch vụ đã chọn: {{
                    session['booking_data']['ten_dich_vu'] }}
                </div>
                {% else %}
                <div class="small text-primary"><i class="fas fa-tooth me-1"></i>
                    Chưa chọn dịch vụ nào
                </div>
                {% endif %}
            </div>
        </div>

        <h4 class="mb-4 fw-bold">Chọn bác sĩ và thời gian</h4>

        <form action="/booking_buoc2" method="POST" id="bookingFormStep2">
            <input type="hidden" name="doctor_id" id="selectedDoctorId" required>

            <div class="mb-4">
                <label class="form-label fw-bold">Bác sĩ <span class="text-danger">*</span></label>
                <div class="row g-3">
                    {% for doctor in doctors %}
                    <div class="col-md-6">
                        <div class="doctor-card" onclick="selectDoctor(this, {{ doctor.id }})">
                            <div>
                                <h6 class="fw-bold mb-1">{{ doctor.ho_ten }}</h6>
                                <div class="small text-muted">Răng hàm mặt</div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6 mb-3 mb-md-0">
                    <label for="bookingDate" class="form-label fw-bold">Ngày khám <span
                            class="text-danger">*</span></label>
                    <input type="date" class="form-control form-control-custom" id="bookingDate" name="booking_date"
                           required>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">Giờ khám <span class="text-danger">*</span></label>
                    <div class="row g-2">
                        {% for slot in time_slots %}
                        <div class="col-6 col-sm-4">
                            <input type="radio" class="btn-check" name="time_slot" id="slot{{ loop.index }}"
                                   value="{{ slot }}" required autocomplete="off">
                            <label class="btn time-slot-btn" for="slot{{ loop.index }}">{{ slot }}</label>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-between mt-5">
                <a href="/booking"
                   class="btn btn-outline-secondary px-4 py-2 fw-medium rounded-3">
                    Quay lại
                </a>
                <button type="submit" class="btn btn-primary px-5 py-2 fw-bold rounded-3" id="btnContinueStep2"
                        disabled>
                    Tiếp tục
                </button>
            </div>
        </form>

    </div>

    <div class="container" style="max-width: 800px;">
        <div class="mt-4 p-3 bg-white rounded-3 border">
            <div class="small text-muted"><i class="fas fa-headset me-2 text-primary"></i> Hotline hỗ trợ: <span
                    class="text-dark fw-bold">1900.1234</span></div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/booking.js') }}"></script>
{% endblock %}